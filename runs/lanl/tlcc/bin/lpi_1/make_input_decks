#!/bin/bash

test_home=../../../../../VPIC_Test_Decks/lpi/lpi_1

#######################################################################
# Set run parameters.

np=$1
nnodes=$2
nppn=$3
ntpp=$4
nppc=$5
nstep=$6
nrestart=$7
size=$8

#######################################################################
# Edit the input file to use our configurable input parameters.

update='
s/REPLACE_Ly_scale/'$((10#${nnodes}))'/
s/REPLACE_topology_y_scale/'$((10#${nnodes}))'/
s/REPLACE_ny_scale/'$((10#${nnodes}))'/
s/REPLACE_nppc/'${nppc}'/
s/REPLACE_nstep/'${nstep}'/
s/REPLACE_nrestart/'${nrestart}'/
'

cat ${test_home}/lpi_np_${np}.template.cxx | sed -e "$update" >& lpi_${size}_nn_${nnodes}_nppn_${nppn}_ntpp_${ntpp}.cxx
